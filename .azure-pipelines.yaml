pr:
  - master

jobs:

- job: Windows
  pool:
    vmImage: windows-2019
  steps:
  - powershell: ./build.ps1 -Target Build

- job: Linux
  pool:
    vmImage: ubuntu-16.04
  steps:
  - script: ./build.sh

- job: Delivery
  dependsOn:
  - Windows
  - Linux
  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))
  pool:
    vmImage: windows-2019
  steps:
    - powershell:  ./build.ps1 -Target Publish-Nuget
